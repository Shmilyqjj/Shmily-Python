#!/usr/bin/env python
# encoding: utf-8
"""
:Author: shmily
:Create Time: 2023/8/8 下午3:44
:@File: check_reassign_file.py.py
:@Software: PyCharm
:@Site: shmily-qjj.top
"""

reassign_json = {"version":1,"partitions":[{"topic":"t_rcv4","partition":49,"replicas":[10,17,1],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":60,"replicas":[16,12,13],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":38,"replicas":[14,3,18],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":27,"replicas":[17,14,12],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":8,"replicas":[7,11,4],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":19,"replicas":[4,0,6],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":30,"replicas":[0,2,7],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":2,"replicas":[4,9,0],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":57,"replicas":[13,4,5],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":13,"replicas":[0,13,2],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":35,"replicas":[11,0,6],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":24,"replicas":[2,11,4],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":46,"replicas":[9,2,7],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":62,"replicas":[1,2,7],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":5,"replicas":[12,10,3],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":16,"replicas":[3,16,17],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":32,"replicas":[10,16,17],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":21,"replicas":[14,10,3],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":10,"replicas":[17,5,14],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":54,"replicas":[5,3,18],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":43,"replicas":[16,14,12],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":59,"replicas":[7,14,12],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":48,"replicas":[6,16,17],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":51,"replicas":[18,0,6],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":40,"replicas":[13,11,4],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":18,"replicas":[11,9,0],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":29,"replicas":[9,13,2],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":7,"replicas":[2,18,11],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":34,"replicas":[18,9,0],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":45,"replicas":[1,13,2],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":56,"replicas":[12,11,4],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":37,"replicas":[5,10,3],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":26,"replicas":[16,5,14],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":15,"replicas":[10,7,16],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":4,"replicas":[14,6,10],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":31,"replicas":[6,7,16],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":20,"replicas":[5,6,10],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":42,"replicas":[7,5,14],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":53,"replicas":[4,10,3],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":9,"replicas":[16,4,5],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":12,"replicas":[9,12,13],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":23,"replicas":[13,18,11],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":1,"replicas":[11,1,9],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":28,"replicas":[1,12,13],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":17,"replicas":[18,1,9],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":6,"replicas":[13,3,18],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":39,"replicas":[12,18,11],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":50,"replicas":[3,1,9],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":61,"replicas":[17,13,2],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":55,"replicas":[14,18,11],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":47,"replicas":[0,7,16],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":36,"replicas":[4,6,10],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":25,"replicas":[7,4,5],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":14,"replicas":[6,2,7],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":3,"replicas":[5,0,6],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":58,"replicas":[2,5,14],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":52,"replicas":[11,6,10],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":63,"replicas":[9,7,16],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":41,"replicas":[2,4,5],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":0,"replicas":[18,17,1],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":44,"replicas":[17,12,13],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":33,"replicas":[3,17,1],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":22,"replicas":[12,3,18],"log_dirs":["any","any","any"]},{"topic":"t_rcv4","partition":11,"replicas":[1,14,12],"log_dirs":["any","any","any"]}]}
# reassign_json = {"version": 1, "partitions": [{"topic": "t_rcv4", "partition": 0, "replicas": [0, 1, 2], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 1, "replicas": [1, 2, 3], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 2, "replicas": [2, 3, 4], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 3, "replicas": [3, 4, 5], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 4, "replicas": [4, 5, 6], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 5, "replicas": [5, 6, 7], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 6, "replicas": [6, 7, 9], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 7, "replicas": [7, 9, 10], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 8, "replicas": [9, 10, 11], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 9, "replicas": [10, 11, 12], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 10, "replicas": [11, 12, 13], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 11, "replicas": [12, 13, 14], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 12, "replicas": [13, 14, 16], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 13, "replicas": [14, 16, 17], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 14, "replicas": [16, 17, 18], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 15, "replicas": [17, 18, 0], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 16, "replicas": [18, 0, 1], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 17, "replicas": [0, 1, 2], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 18, "replicas": [1, 2, 3], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 19, "replicas": [2, 3, 4], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 20, "replicas": [3, 4, 5], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 21, "replicas": [4, 5, 6], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 22, "replicas": [5, 6, 7], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 23, "replicas": [6, 7, 9], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 24, "replicas": [7, 9, 10], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 25, "replicas": [9, 10, 11], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 26, "replicas": [10, 11, 12], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 27, "replicas": [11, 12, 13], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 28, "replicas": [12, 13, 14], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 29, "replicas": [13, 14, 16], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 30, "replicas": [14, 16, 17], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 31, "replicas": [16, 17, 18], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 32, "replicas": [17, 18, 0], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 33, "replicas": [18, 0, 1], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 34, "replicas": [0, 1, 2], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 35, "replicas": [1, 2, 3], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 36, "replicas": [2, 3, 4], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 37, "replicas": [3, 4, 5], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 38, "replicas": [4, 5, 6], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 39, "replicas": [5, 6, 7], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 40, "replicas": [6, 7, 9], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 41, "replicas": [7, 9, 10], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 42, "replicas": [9, 10, 11], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 43, "replicas": [10, 11, 12], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 44, "replicas": [11, 12, 13], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 45, "replicas": [12, 13, 14], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 46, "replicas": [13, 14, 16], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 47, "replicas": [14, 16, 17], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 48, "replicas": [16, 17, 18], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 49, "replicas": [17, 18, 0], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 50, "replicas": [18, 0, 1], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 51, "replicas": [0, 1, 2], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 52, "replicas": [1, 2, 3], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 53, "replicas": [2, 3, 4], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 54, "replicas": [3, 4, 5], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 55, "replicas": [4, 5, 6], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 56, "replicas": [5, 6, 7], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 57, "replicas": [6, 7, 9], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 58, "replicas": [7, 9, 10], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 59, "replicas": [9, 10, 11], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 60, "replicas": [10, 11, 12], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 61, "replicas": [11, 12, 13], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 62, "replicas": [12, 13, 14], "log_dirs": ["any", "any", "any"]}, {"topic": "t_rcv4", "partition": 63, "replicas": [13, 14, 16], "log_dirs": ["any", "any", "any"]}]}


leader_count = {}
partitions_num_in_broker = {}
partitions = reassign_json["partitions"]
for partition in partitions:
    partition_id = partition.get("partition")
    replicas = partition.get("replicas")
    leader_broker = replicas[0]
    if leader_count.get(leader_broker) is not None:
        leader_count[leader_broker] += 1
    else:
        leader_count[leader_broker] = 1
    for broker_id in replicas:
        if partitions_num_in_broker.get(broker_id) is not None:
            partitions_num_in_broker[broker_id] += 1
        else:
            partitions_num_in_broker[broker_id] = 1

leader_count = {x[0]: x[1] for x in sorted(leader_count.items(), key=lambda x: x[0], reverse=False)}
partitions_num_in_broker = {x[0]: x[1] for x in sorted(partitions_num_in_broker.items(), key=lambda x: x[0], reverse=False)}

print("Leader partition num in per broker: " + str(leader_count))
print("Partition num in per broker: " + str(partitions_num_in_broker))

